{"version":3,"sources":["webpack:///./src/pages/index.tsx"],"names":["BEGINNING_OF_REIWA","Date","getTime","Page","styled","div","withConfig","displayName","componentId","Stage","Result","IndexPage","props","_this","_React$Component","call","this","state","usingRemoteTime","isitheisei","now","componentDidMount","_callee","_this2","_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","wrap","_context","prev","next","triggerFirstUpdateTimer","window","setTimeout","updateNtpCurrent","checkTimer","setInterval","checkIsitheisei","stop","componentWillUnmount","clearTimeout","clearInterval","_callee2","_ref","headers","currentDate","_context2","axios","head","sent","remoteCurrentTimeReceivedAt","date","remoteCurrentTime","getMilliseconds","setState","finish","_this3","current","updateTimer","render","react__WEBPACK_IMPORTED_MODULE_5___default","createElement","resultWord","React","Component"],"mappings":"qQAKMA,EAAqB,IAAIC,KAAK,6BAA6BC,UAE3DC,EAAOC,IAAOC,IAAVC,WAAA,CAAAC,YAAA,cAAAC,YAAA,YAAGJ,CAAH,MAEJK,EAAQL,IAAOC,IAAVC,WAAA,CAAAC,YAAA,eAAAC,YAAA,YAAGJ,CAAH,gHAWLM,EAASN,IAAOC,IAAVC,WAAA,CAAAC,YAAA,gBAAAC,YAAA,YAAGJ,CAAH,qBASSO,cAOnB,SAAAA,EAAYC,GAAW,IAAAC,EAAA,OACrBA,EAAAC,EAAAC,KAAAC,KAAMJ,IAANI,MAEKC,MAAQ,CACXC,gBAAiB,SACjBC,WAAYlB,KAAKmB,MAAQpB,GALNa,sCASjBQ,gDAAN,SAAAC,IAAA,IAAAC,EAAAP,KAAA,OAAAQ,EAAAC,EAAAC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OACEb,KAAKc,wBAA0BC,OAAOC,WAAW,WAC/CT,EAAKU,oBACJ,KAEHjB,KAAKkB,WAAaH,OAAOI,YAAY,WACnCZ,EAAKa,mBACJ,KAPL,wBAAAT,EAAAU,SAAAf,EAAAN,gEAUAsB,qBAAA,WACEP,OAAOQ,aAAavB,KAAKc,yBACzBC,OAAOS,cAAcxB,KAAKkB,eAGdD,+CAAd,SAAAQ,IAAA,IAAAC,EAAAC,EAAAC,EAAA,OAAApB,EAAAC,EAAAC,KAAA,SAAAmB,GAAA,cAAAA,EAAAjB,KAAAiB,EAAAhB,MAAA,cAAAgB,EAAAjB,KAAA,EAAAiB,EAAAhB,KAAA,EAE8BiB,IAAMC,KAAK,aAFzC,OAAAL,EAAAG,EAAAG,KAEYL,EAFZD,EAEYC,QACFC,EAAc,IAAI3C,KAExBe,KAAKiC,4BAA8BL,EAAY1C,UAEnB,iBAAjByC,EAAQO,OACjBlC,KAAKmC,kBAAqB,IAAIlD,KAAK0C,EAAQO,MAAOhD,UAAY0C,EAAYQ,kBAC1EpC,KAAKqC,SAAS,CAAEnC,gBAAiB,aATvC,cAAA2B,EAAAjB,KAAA,EAYSZ,KAAKmC,mBAAsBnC,KAAKiC,6BACnCjC,KAAKqC,SAAS,CAAEnC,gBAAiB,WAbvC2B,EAAAS,OAAA,4BAAAT,EAAAR,SAAAI,EAAAzB,KAAA,uEAkBQoB,gBAAR,WAA0B,IAAAmB,EAAAvC,KACpBwC,EAAUvD,KAAKmB,MACfJ,KAAKmC,mBAAqBnC,KAAKiC,8BACjCO,EAAUxC,KAAKmC,mBAAqBK,EAAUxC,KAAKiC,8BAGrDjC,KAAKqC,SAAS,CAAElC,WAAYqC,EAAUxD,IAElCA,EAAqBwD,IACvBzB,OAAOQ,aAAavB,KAAKyC,aACzBzC,KAAKyC,YAAc1B,OAAOC,WAAW,WACnCuB,EAAKF,SAAS,CAAElC,YAAY,KAC3BnB,EAAqBwD,OAQ5BE,OAAA,WACE,OACEC,EAAAlC,EAAAmC,cAACzD,EAAD,KACEwD,EAAAlC,EAAAmC,cAACnD,EAAD,KACEkD,EAAAlC,EAAAmC,cAAClD,EAAD,KAASM,KAAK6C,uDAPpB,OAAO7C,KAAKC,MAAME,WAAa,KAAO,aAlEH2C,IAAMC","file":"component---src-pages-index-tsx-bd00f4fbf721d7ebe99c.js","sourcesContent":["import React from 'react';\nimport styled from 'styled-components';\nimport Helmet from 'react-helmet';\nimport axios from 'axios';\n\nconst BEGINNING_OF_REIWA = new Date('2019-05-01T00:00:00+09:00').getTime();\n\nconst Page = styled.div``;\n\nconst Stage = styled.div`\n  display: flex;\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Result = styled.div`\n  font-size: 40px;\n`;\n\ninterface State {\n  usingRemoteTime: 'notyet' | 'success' | 'failed';\n  isitheisei: boolean;\n};\n\nexport default class IndexPage extends React.Component<{}, State> {\n  private remoteCurrentTime?: number;\n  private remoteCurrentTimeReceivedAt?: number;\n  private updateTimer?: number;\n  private triggerFirstUpdateTimer?: number;\n  private checkTimer?: number;\n\n  constructor(props: {}) {\n    super(props);\n\n    this.state = {\n      usingRemoteTime: 'notyet',\n      isitheisei: Date.now() < BEGINNING_OF_REIWA\n    };\n  }\n\n  async componentDidMount() {\n    this.triggerFirstUpdateTimer = window.setTimeout(() => {\n      this.updateNtpCurrent();\n    }, 1000);\n\n    this.checkTimer = window.setInterval(() => {\n      this.checkIsitheisei();\n    }, 1000);\n  }\n\n  componentWillUnmount() {\n    window.clearTimeout(this.triggerFirstUpdateTimer);\n    window.clearInterval(this.checkTimer);\n  }\n\n  private async updateNtpCurrent() {\n    try {\n      const { headers } = await axios.head('/void.txt');\n      const currentDate = new Date();\n\n      this.remoteCurrentTimeReceivedAt = currentDate.getTime();\n\n      if (typeof headers.date === 'string') {\n        this.remoteCurrentTime = (new Date(headers.date)).getTime() + currentDate.getMilliseconds();\n        this.setState({ usingRemoteTime: 'success' });\n      }\n    } finally {\n      if (!this.remoteCurrentTime || !this.remoteCurrentTimeReceivedAt) {\n        this.setState({ usingRemoteTime: 'failed' });\n      }\n    }\n  }\n\n  private checkIsitheisei() {\n    let current = Date.now();\n    if (this.remoteCurrentTime && this.remoteCurrentTimeReceivedAt) {\n      current = this.remoteCurrentTime + (current - this.remoteCurrentTimeReceivedAt);\n    }\n\n    this.setState({ isitheisei: current < BEGINNING_OF_REIWA });\n\n    if (BEGINNING_OF_REIWA > current) {\n      window.clearTimeout(this.updateTimer);\n      this.updateTimer = window.setTimeout(() => {\n        this.setState({ isitheisei: true });\n      }, BEGINNING_OF_REIWA - current);\n    }\n  }\n\n  private get resultWord(): string {\n    return this.state.isitheisei ? 'はい' : 'いいえ';\n  }\n\n  render() {\n    return (\n      <Page>\n        <Stage>\n          <Result>{this.resultWord}</Result>\n        </Stage>\n      </Page>\n    );\n  }\n}\n"],"sourceRoot":""}